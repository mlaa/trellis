---

- name: "Development server on AWS EC2"
  hosts: "all"
  sudo: "yes"
  remote_user: "ubuntu"
  vars:
    admin_user: "{{ ansible_ssh_user }}"
    web_user: "www-data"
  vars_files:
    - "vars/commons.yml"
    - "vars/sudoer_passwords.yml"

  roles:
    - { role: common, tags: [common] }
    - { role: common-additions, tags: [common, common-additions] }
    - { role: sshd, tags: [sshd, server] }
    - { role: aws, tags: [aws] }
    - { role: fail2ban, tags: [fail2ban] }
    - { role: ferm, tags: [ferm] }
    - { role: ntp }
    - { role: users, tags: [users] }
    - { role: mariadb, tags: [mariadb] }
    - { role: nullmailer, tags: [nullmailer] }
    - { role: php, when: not hhvm, tags: [php] }
    - { role: hhvm, when: hhvm, tags: [hhvm] }
    - { role: php5-xdebug, tags: [xdebug], when: xdebug_install | default(False) }
    - { role: nginx, tags: [nginx] }
    - { role: logrotate, tags: [logrotate] }
    - { role: memcached, tags: [memcached] }
    - { role: composer, tags: [composer] }
    - { role: wp-cli, tags: [wp-cli] }
    - { role: wordpress-setup, tags: [wordpress, wordpress-setup] }
    - { role: wordpress-import, tags: [wordpress, wordpress-import] }
